<mat-card class="card">
    <div class="header">
        <mat-card-subtitle>
            <mat-icon>edit</mat-icon> 
        </mat-card-subtitle> 
        <mat-card-subtitle> 
            <div class="local">{{ local }}</div> 
        </mat-card-subtitle> 
        <mat-card-subtitle> 
            <button mat-button class="button-close" (click)="close()"><mat-icon>close</mat-icon></button> 
        </mat-card-subtitle> 
    </div> 
    <mat-card-content>
      <mat-tab-group>
        <mat-tab label="DADOS">
          <div class="wrapper fadeInDown">
          <div id="formContent">
          <!-- Login Form -->
          <form [formGroup]="dadosGeraisForm"> 

            <table class="full-width" cellspacing="0">
              <tr>
              <td><mat-form-field class="full-width" appearance="fill">
                <mat-label>ID@</mat-label>
                <input matInput id="codigo" class="fadeIn second" name="codigo" placeholder="id@" formControlName="codigo" maxlength="20" 
                [ngClass]="{ 'is-invalid': f.codigo.errors }" />
                <div *ngIf="submitted && f.codigo.errors" class="invalid-feedback">
                  <div *ngIf="submitted && f.codigo.errors.required" style="color: rgb(0, 139, 58);">Informe o código.</div>
                </div>
                </mat-form-field>
              </td>
              <td>
                <mat-form-field class="full-width" appearance="fill">
                <mat-label>Nome</mat-label>
                <input matInput  id="nome" class="fadeIn third" name="nome" placeholder="NOME" formControlName="nome" maxlength="40"
                [ngClass]="{ 'is-invalid': f.nome.errors }" />
                <div *ngIf="submitted && f.nome.errors" class="invalid-feedback">
                  <div *ngIf="submitted && f.nome.errors.required" style="color: rgb(0, 139, 58);">Informe o nome do cliente.</div>
                </div>
              </mat-form-field>
              </td>
              <td>
                <mat-form-field class="full-width" appearance="fill">
                <mat-label>Telefone</mat-label>
                <input matInput id="fone" class="fadeIn third" name="fone" placeholder="fone" formControlName="fone" maxlength="40"/> 
              </mat-form-field>
              </td>
            </tr> 
            </table>  
              <mat-form-field class="full-width" appearance="fill">
                <mat-label>Email</mat-label>
                <input matInput id="email" class="fadeIn third" name="email" placeholder="email" formControlName="email" maxlength="60" /> 
              </mat-form-field>  
            <div *ngIf="erro" style="color: red;">{{erro}}</div> 
          </form>
          </div>
        </div>
        </mat-tab>
        <mat-tab label="ENDEREÇO">
          <div class="wrapper fadeInDown">
            <div id="formContent">
            <!-- Login Form -->
            <form [formGroup]="dadosGeraisForm"> 
  
              <table class="full-width" cellspacing="0">
                <tr>
                <td><mat-form-field class="full-width" appearance="fill">
                  <mat-label>CEP</mat-label>
                    <input matInput id="cepres"class="fadeIn second" #cep (change)="getCep(cep.value)"
                      maxlength="8" placeholder="cep" formControlName="cepres">
                    <mat-hint align="end">{{cep.value.length}} / 8</mat-hint> 
                  </mat-form-field>
                </td>
                <td>
                  <mat-form-field class="full-width" appearance="fill">
                  <mat-label>Rua</mat-label>
                  <input matInput  id="endres" class="fadeIn third" name="endres" placeholder="Rua" formControlName="endres" maxlength="40" /> 
                </mat-form-field>
                </td> 
              </tr> 
              </table>   
                <table class="full-width" cellspacing="0"><tr>
                  <td>
                    <mat-form-field class="full-width" appearance="fill">
                    <mat-label>Cidade</mat-label>
                    <input matInput class="fadeIn third" name="cidres" placeholder="Cidade" formControlName="cidres">
                  </mat-form-field>
                  </td>
                  <td>
                    <mat-form-field class="full-width" appearance="fill">
                    <mat-label>Bairro</mat-label>
                    <input matInput id="bairres" class="fadeIn third" name="bairres" placeholder="Bairro" formControlName="bairres" maxlength="40"/> 
                  </mat-form-field>
                  </td>
                  <td><mat-form-field appearance="fill">
                    <mat-label>UF</mat-label>
                    <mat-select role="combobox" style="color: cornflowerblue" formControlName="ufres">
                      <mat-option *ngFor="let uf of ufs" [value]="uf.uf">
                        {{ uf.uf }} - {{ uf.nome}}
                      </mat-option>
                    </mat-select>
                    </mat-form-field></td>
                  <td> 
                </tr></table>  
              <div *ngIf="erro" style="color: red;">{{erro}}</div> 
            </form> 
            </div>
          </div>
        </mat-tab>
        <mat-tab label="MODULOS">
          <div class="fadeInDown">
          <div id="content">
            <table class="full-width" cellspacing="0">
            <tr>
              <td><mat-form-field appearance="fill">
                <mat-label>Modulos </mat-label>
                <mat-select role="combobox" [(ngModel)]="moduloSelecionado" style="color: cornflowerblue">
                  <mat-option *ngFor="let m of modulos" [value]="m.NOME">
                    {{m.NOME}}
                  </mat-option>
                </mat-select>
                </mat-form-field></td>
              <td>
                <section class="section">
                  <mat-checkbox class="margin" [(ngModel)]="ativo">Ativo</mat-checkbox> 
                </section> 
              </td>
              <td>
                <button mat-button (click)="incluirModulo()" class="button-add">Incluir</button> 
              </td>
            </tr>
            </table>
            </div>
          </div>
           <!-- GRID -->
           <div class="mat-elevation-z8">
            <table mat-table [dataSource]="dataSourceModulos" matSort>  
              <!-- Nome Column -->
              <ng-container matColumnDef="nome">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                <td mat-cell *matCellDef="let row"> {{row.nome }} </td>
              </ng-container>  
              <!-- Tipo Column -->
              <!-- Checkbox Column -->
              <ng-container matColumnDef="enabled">
                <th mat-header-cell *matHeaderCellDef>Ativo
                  <mat-checkbox (change)="$event ? masterToggle() : null;"
                                [checked]="selection.hasValue() && isAllSelected()"
                                [indeterminate]="selection.hasValue() && !isAllSelected()"
                                [disabled]="!dataSourceModulos">
                  </mat-checkbox>
                </th>
                <td mat-cell *matCellDef="let row">
                  <mat-checkbox (click)="$event.stopPropagation()"
                                (change)="$event ? selection.toggle(row) : null; saveSelect($event, row)"
                                [checked]="row.enabled || selection.isSelected(row)">
                  </mat-checkbox>
                </td>
              </ng-container>

              <ng-container matColumnDef="remove">
                <th mat-header-cell *matHeaderCellDef>Remover</th>
                <td mat-cell *matCellDef="let row">
                  <button mat-button (click)="removerModulo(row.nome)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </td>
              </ng-container>
 
              <tr mat-header-row *matHeaderRowDef="displayedColumnsModulos"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumnsModulos;"></tr>
           
            </table> 
            <mat-paginator #paginatorModulo  [pageSizeOptions]="[5]" aria-label="Select page of users"></mat-paginator>
            <table class="full-width" cellspacing="0">
              <tr>
                <td>
                  <div *ngIf="erro" style="color: red; text-align: center;">{{erro}}</div> 
                </td>
              </tr>
            </table> 
          </div>   
             
        </mat-tab>
        <mat-tab label="ACESSO"> 
          <div class="fadeInDown"> 
              <table class="full-width" cellspacing="0">
              <tr>
                <td>
                  <section class="section">
                    <mat-checkbox class="margin" [(ngModel)]="ativo">Ativo</mat-checkbox> 
                  </section> 
                </td>
                <td>
                  <mat-form-field class="full-width" appearance="fill">
                    <mat-label>Unuario</mat-label>
                    <input matInput class="fadeIn third" name="username" [(ngModel)]="username" placeholder="Unuario">
                  </mat-form-field> 
                  <mat-form-field class="full-width" appearance="fill">
                    <mat-label>Senha</mat-label>
                    <input matInput class="fadeIn third" name="password"  [(ngModel)]="password" placeholder="Senha"> 
                  </mat-form-field> 
                </td>  
                <td>
                  <button mat-button (click)="incluirUsuario()" class="button-add">Incluir</button> 
                </td>
                
              </tr>
             
              </table> 
            </div>
            <!-- GRID -->
            <div class="mat-elevation-z8">
              <table mat-table [dataSource]="dataSourceAcessos" matSort>  
                <!-- Nome Column -->
                <ng-container matColumnDef="username">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Nome </th>
                  <td mat-cell *matCellDef="let row"> {{row.username}} </td>
                </ng-container>  

                 <!-- Tipo Column -->
                 <ng-container matColumnDef="type">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Tipo </th>
                  <td mat-cell *matCellDef="let row"> {{ row.type }} </td>
                </ng-container>

                <!-- Tipo Column -->
                <!-- Checkbox Column -->
                <ng-container matColumnDef="enabled">
                  <th mat-header-cell *matHeaderCellDef>Ativo
                    <mat-checkbox (change)="$event ? masterToggleAcesso() : null"
                                  [checked]="selectionAcesso.hasValue() && isAllSelectedAcesso()"
                                  [indeterminate]="selectionAcesso.hasValue() && !isAllSelectedAcesso()"
                                  [disabled]="!dataSourceAcessos">
                    </mat-checkbox>
                  </th>
                  <td mat-cell *matCellDef="let row">
                    <mat-checkbox (click)="$event.stopPropagation()"
                                  (change)="$event ? selectionAcesso.toggle(row) : null ; saveSelectAcessos($event, row)"
                                  [checked]="row.enabled || selectionAcesso.isSelected(row)">
                    </mat-checkbox>
                  </td>
                </ng-container>

                <!-- Tipo Column -->
                <ng-container matColumnDef="created">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Criado </th>
                  <td mat-cell *matCellDef="let row"> {{ row.created | date: 'dd/MM/YYYY'}} </td>
                </ng-container>

                <!-- Tipo Column -->
                <ng-container matColumnDef="updated">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> Atualizado </th>
                  <td mat-cell *matCellDef="let row"> {{ row.updated | date: 'dd/MM/YYYY' }} </td>
                </ng-container>

                <ng-container matColumnDef="remove">
                  <th mat-header-cell *matHeaderCellDef>Remover</th>
                  <td mat-cell *matCellDef="let row">
                    <button mat-button (click)="removerAcesso(row.username)">
                      <mat-icon>delete</mat-icon>
                    </button>
                  </td>
                </ng-container>
            
                <tr mat-header-row *matHeaderRowDef="displayedColumnsAcesso"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsAcesso;" (dblclick)="editarAcesso(row)"  class="element-row"></tr>
             
              </table> 
              <mat-paginator #paginatorAcesso [pageSizeOptions]="[5]" aria-label="Select page of users"></mat-paginator>
              <table class="full-width" cellspacing="0">
                <tr>
                  <td>
                    <div *ngIf="erro" style="color: red; text-align: center;">{{erro}}</div> 
                  </td>
                </tr>
              </table> 
            </div>  
             
        </mat-tab>
      </mat-tab-group>  
    </mat-card-content>
    <mat-divider inset></mat-divider>
    <mat-card-actions class="acions">
      <button mat-button (click)="onSubmit()" class="button-gravar">GRAVAR</button> 
    </mat-card-actions>
    <mat-card-footer>
      <mat-progress-bar mode="indeterminate" [hidden]="isLoading"></mat-progress-bar>
    </mat-card-footer>
  </mat-card>
